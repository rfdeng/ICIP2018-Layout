\section{Introduction}
\label{sec:intro}

The main purpose of indoor scene layout estimation is to extract semantic boundaries among walls, ceiling and floor, and to obtain corresponding semantic planes from a single RGB image, as shown in Fig. \ref{fig:definition}. 


\begin{figure}[!ht]
	\centering
	\textsc{\includegraphics[width=3.5in]{figure/definition.eps}}
	\caption{Illustration of the layout estimation problem. (a) Input images. (b) Layout estimation with semantic labels. (c) Layout visulization superimposed on the input image.}
	\label{fig:definition}
\end{figure}


Room layout estimation is a fundamental problem for indoor scene understanding and plays a critical role in a diverse range of applications, such as scene reconstruction, robot navigation, virtual reality. However, it is challenging that the distinctive clues such as room corners and layout boundaries are often occluded by objects. In addition to the occlusion problem, factors like illumination variations, different angles, objects diversity and cluttering can make the situation worse.


%%
In recent years, many researchers have made massive attempts to estimate indoor room layout from a single image. Conventional methods usually follow a proposing-ranking framework \cite{hedau2009recovering,wang2013discriminative,gupta2010estimating,hedau2010thinking}. Specifically, they first generate numbers of proposals by vanishing point detection and ray sampling. Then a ranking step using hand-crafted features is adopted to output the best hypothesis. Recent methods built on Fully Convulutional Networks(FCNs) achieve impressive performance \cite{mallya2015learning,ren2016coarse,zhang2016learning,dasgupta2016delay,zhao2017physics}. Typically, the FCNs are trained to segment semantic surfaces or to predict boundaries between them. Followed by a postprocessing scheme, the output from FCNs are refined to be consistent with Fig.~\ref{fig:definition}(b). End-to-End approach for room layout estimation also has been explored by \cite{LeeRoomNet17}. They employ an encoder-decoder network to delineate room layout structure using
2D keypoints. 

In this paper, we propose to enhance the FCN's ability for room layout estimation by fully utilizing the geometric information of the scene. To this end, we estimate depth and normal maps from a single image using network in \cite{eigen2015predicting}. Then we integrate these geometric hints to train a multi-channel FCN for semantic surface segmentation. At last, a post-processing algorithm based on \cite{dasgupta2016delay} is applied to generally refine the estimation results. We evaluate our method on two popular benchmark dataset. Experimental results demonstrate that our method is robust and effective for layout estimation even facing clutter and occlusion.






\comments{
One popular framework using a 3D cuboid to approximately express indoor scene layout was introduced by \cite{hedau2009recovering} in 2009. The author generated several layout candidates by using vanish point detection. Then it gathered mid-level features like the line membership features and the geometric context features for each candidate and ranked them by using a structured SVM. Unfortunately, the process of layout candidiate generation is highly sensitive and fragile towards a large amount of clutter. Based on this milestone work, several strategies focused on layout hypothesis generation and ranking were considered. Wang et al.\cite{wang2013discriminative} introduced latent variables to model indoor clttuer. Moreover, in \cite{schwing2012efficient}\cite{schwing2013box}, Schwing et al. modeled cllutterd indoor scenes with higher-order potentials and jointly generated layout and objects with box shapes. Some researchers introduced low-level information as geometric restrictions as supplementary in indoor scene problem. Lee et al.\cite{lee2009geometric}. proposed several physically valid structure hypotheses by geometric reasoning and verified to find the best fitting model to line segments. Ramalingam et al.\cite{ramalingam2013manhattan} employed Manhattan Junction grouping to select best layout. As mentioned above, traditional methods need to design image features manually, which greatly increase the complexity and are weekly capable of adapting to dealing with all complex indoor scenes. Besides, there exists a large time consuming for layout candidate generation, which is stongly against our intention to rely on computers to understand the room layout as fastly as possible.
 

Recently, the deep learning methods and convolution neural network(CNN) have achived impressive progresses in various computer vision tasks, such as semantic segmentation \cite{long2015fully}\cite{chen2016deeplab}, object detection \cite{girshick2015fast}\cite{ren2015faster}, scene understanding \cite{gupta2015indoor}\cite{badrinarayanan2017segnet}, and so on. Towards layout estimation problem, several researchers have achieved to adopt deep learning methods to solve it. Mallya et al.\cite{mallya2015learning}, presented a Fully Convolutional Networks (FCNs)\cite{long2015fully} framwork for learning informative edge maps from a single image, which provided as a new information to sample vanishing lines for layout candidates generation and ranking. This work is the first to train CNN to produce robust features used to replace hand-crafted features towards layout estimation problem. However, in the framwork of layout candidates generation and ranking, their algorithm still remained time-consuming. Dasgupta et al.\cite{dasgupta2016delay} used the FCN to learn semantic surface labels including left wall, front wall, right wall, ceiling, and ground. Initial layout generation and optimization were all based on suface belif labels. Unfortunately, Their algorithm relies entirely on FCN's precision for semantic surface labels. In other words, if FCN result gains two much error, we may get totally wrong prediction. Moreover, optimization procedure does not utilize any restrictions based on edge information, just taking random combinations of edges instead, which is geometric inconformity compared with RGB images. Ren et al.\cite{ren2016coarse} adopted a multi-task fully convolutional neural network (MFCN) to jointly predict the room edges and semantic labels. Then a coarse-to-fine method was adopted which enforced several constraints such as layout contour straightness, surface smoothness and geometric constraints to generate fine layout from coarse prediction of room edges. They have considerd geometric constraints to predict high quality estimation results. They need complex geometric computation and rules to generate useful critical lines, however, such low-level features are exactly what we avoid to extract. Zhang et al.\cite{zhang2016learning} used another deconvolution network which has multi-layer deconvolution and a receptive field as large as the entire image compared to FCN. As the result, they can obtain highly reliable edge maps. Then they follow the framework of layout candidates generation using vanish line samplling with an adaptive line sample strategy for robustness and time reduction. A measurement of similarity is proposed between edge map and layout candidates for ranking. Unexpectedly, their results are less precise compared with \cite{dasgupta2016delay}\cite{ren2016coarse}. One explanation may be that the latter two optimization strategies are more effective compared to vanish line sampling.

\cxj{compared to \cite{ren2016coarse}, what is our advantage? They apply geometric constraints as an optimization problem. \cite{dasgupta2016delay} also apply a post-processing step to enforce geometric constraints. One big disadvantage of the post-processing is that it takes seconds to optimize the layout. \cite{dasgupta2016delay} requires 30 seconds for the layout optimization.}\\
\drf{compared to \cite{ren2016coarse}, we have better performance on layout estimation before optimization. ie. the output of our FCN-MC are more reliable because we apply additional information(depth and normals). We use the same post-processing step in \cite{dasgupta2016delay}, so we have the same problem.}

\cxj{\cite{LeeRoomNet17} presents an end-to-end trainable network that predicts the layout corners and room type A RNNN framework is employed to refine the layout. Different from previous pixel-based representation of the layout, they use a keypoint-based representation.  }

In this work, our algorithm is based on framework of \cite{dasgupta2016delay}, which does not need to extract low features of lines and vanish points from a single RGB image. To enhance the existed FCN's ability, we use networks to estimate depth and normal information from one single RGB image. Then depth and normal information serves as geomtric embedded into FCN networks to jointly generate high quality suface maps and edge maps. Based on\cite{dasgupta2016delay} optimization framwork, we introduce more geometric constraints from predicted edge maps to optimize surface labels to generate high quality layout estimation. Experimental results demonstrate that our method is robust and effective for layout estimation even facing a high clutter on two popular room layout benchmark datasets.
}